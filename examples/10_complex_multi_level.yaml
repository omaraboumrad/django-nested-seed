# Complex Multi-Level Nesting
# Combine all relationship types for complex data structures
#
# Models:
# -------
# from django.contrib.auth.models import User
#
# class Profile(models.Model):
#     user = models.OneToOneField(User, on_delete=models.CASCADE, related_name="profile")
#     role = models.CharField(max_length=20)
#     timezone = models.CharField(max_length=50)
#
# class Category(models.Model):
#     name = models.CharField(max_length=100)
#     slug = models.SlugField(unique=True)
#
# class Publisher(models.Model):
#     name = models.CharField(max_length=100)
#     country = models.CharField(max_length=100)
#
# class Company(models.Model):
#     name = models.CharField(max_length=100)
#     code = models.CharField(max_length=20)
#
# class Membership(models.Model):
#     user = models.ForeignKey(User, on_delete=models.CASCADE)
#     team = models.ForeignKey('Team', on_delete=models.CASCADE)
#     role = models.CharField(max_length=50)
#     date_joined = models.DateField()
#
# class Team(models.Model):
#     name = models.CharField(max_length=100)
#     company = models.ForeignKey(Company, on_delete=models.CASCADE)
#     members = models.ManyToManyField(User, through=Membership, related_name="teams")
#
# class Author(models.Model):
#     user = models.ForeignKey(User, on_delete=models.CASCADE, related_name="authors")
#     pen_name = models.CharField(max_length=100)
#     bio = models.TextField()
#
# class Book(models.Model):
#     title = models.CharField(max_length=200)
#     author = models.ForeignKey(Author, on_delete=models.CASCADE, related_name="books")
#     publisher = models.ForeignKey(Publisher, on_delete=models.CASCADE, related_name="books")
#     categories = models.ManyToManyField(Category, related_name="books")
#     status = models.CharField(max_length=20, choices=STATUS_CHOICES)
#     published_at = models.DateField(null=True, blank=True)

auth:
  User:
    - username: "admin"
      email: "admin@example.com"
      is_staff: true
      is_superuser: true
      profile:  # OneToOne nesting
        role: "ADMIN"
        timezone: "America/New_York"

    - $ref: alice
      username: "alice"
      email: "alice@example.com"
      profile:
        role: "ENGINEER"
        timezone: "America/Los_Angeles"

    - $ref: bob
      username: "bob"
      email: "bob@example.com"
      profile:
        role: "ENGINEER"
        timezone: "Europe/London"

testapp:
  Category:
    - $ref: python
      name: "Python"
      slug: "python"

  Publisher:
    - $ref: oreilly
      name: "O'Reilly Media"
      country: "USA"

  Company:
    - name: "Tech Corp"
      code: "TECH"
      team_set:  # Reverse ForeignKey nesting
        - name: "Engineering Team"
          members:  # M2M with through model
            - user: "$alice"
              role: "Lead Engineer"
              date_joined: "2024-01-01"
            - user: "$bob"
              role: "Senior Developer"
              date_joined: "2024-01-15"

        - name: "Product Team"
          members:
            - user: "$alice"
              role: "Tech Lead"
              date_joined: "2024-02-01"

  Author:
    - user: "$alice"  # ForeignKey reference
      pen_name: "Alice Smith"
      bio: "Software engineer and technical writer"
      books:  # Reverse ForeignKey
        - title: "Python Design Patterns"
          publisher: "$oreilly"
          status: "PUBLISHED"
          published_at: "2024-03-15"
          categories:  # Mixed M2M: references + inline
            - "$python"
            - name: "Design Patterns"
              slug: "design-patterns"
            - name: "Software Engineering"
              slug: "software-engineering"

        - title: "Django Deep Dive"
          publisher: "$oreilly"
          status: "DRAFT"
          categories:
            - "$python"
            - name: "Django"
              slug: "django"
